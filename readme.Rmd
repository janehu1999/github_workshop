---
title: "Horror Films"
always_allow_html: true
output:
  github_document:
    toc: true
    toc_depth: 2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

## Scraping Data

Since we are rolling up on the spookiest holiday, it might be worth pulling in some data on horror movies. Not surprisingly, Wikipedia has some information about the top-grossing horror movies of all time.

```{r, results='asis'}
library(rvest)

topGrossingLink <- "https://en.wikipedia.org/wiki/List_of_highest-grossing_horror_films"

horrorMovies <- read_html(topGrossingLink) %>% 
  html_table(fill = TRUE) %>% 
  `[[`(1)

DT::datatable(horrorMovies)
```

As per usual, we will likely need to clean some of those dollar values up just a little bit:

```{r}
horrorMovies$`Worldwide gross` <- gsub("\\$|,", 
                                       "", 
                                       horrorMovies$`Worldwide gross`)

horrorMovies$`Worldwide gross` <- as.numeric(horrorMovies$`Worldwide gross`)
```

All looks good now!

```{r, echo = FALSE}
skimr::skim(horrorMovies$`Worldwide gross`)
```

Which studios tend to do well with making money off horror?

```{r}
library(data.table)

horrorMovies <- as.data.table(horrorMovies)

sortedStudio <- horrorMovies[, 
                             .(average = mean(`Worldwide gross`)), 
                             by = Studio][order(-average)]

rmarkdown::paged_table(sortedStudio)
```


## Plotting Data

Just for the fun of it, let's do some plotting over the years:

```{r}
library(plotly)

plot_ly(horrorMovies, x = ~Year, y = ~`Worldwide gross`,
        type = "scatter", mode = "markers",
        text = ~paste("Film: ", Film, '<br>Studio: ', Studio, sep = ""))
```

We saw some averages for the studios earlier, so let's get a better idea about each studios distribution within the list:

```{r}
plot_ly(horrorMovies, x = ~`Worldwide gross`, y = ~Studio, 
        type = "box")
```

